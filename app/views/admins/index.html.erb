<h1> <%= "#{t('.users')} (##{User.count})" %> </h1>



<%= form_for users_path, data: { turbo_frame: :results }, method: :get do %>
  <%= fields_for 'search' do |search_form| %>
    <div><%= search_form.search_field :email,  placeholder: t('.search_by_email'),
                          oninput: 'this.form.requestSubmit()', autofocus: true, autocomplete: 'off' %></div>
    <div>
      <%= search_form.label :role, t('.search_by_role') %>
      <%= search_form.select(:role, Role.all.collect { |role| role.name}, { include_blank: t('.select_role') }) %>
    </div>
    <div><%= t('.user_date_range') %></div>
    <div>
      <%= search_form.label :created_at_to, t('.to') %>
      <%= search_form.date_select :created_at_to, include_blank: true %>
    </div>
    <div>
      <%= search_form.label :created_at_from, t('.from') %>
      <%= search_form.date_select :created_at_from, include_blank: true %>
    </div>
    <div><%= t('.order_date_range') %></div>
    <div>
      <%= search_form.label :order_created_at_to, t('.to') %>
      <%= search_form.date_select :order_created_at_to, include_blank: true %>
    </div>
    <div>
      <%= search_form.label :order_created_at_from, t('.from') %>
      <%= search_form.date_select :order_created_at_from, include_blank: true %>
    </div>
    <div>
      <%= search_form.label :sort, t('.sort') %>
      <div>
        <%= search_form.label :sort_email, t('.sort_email') %>
        <%= search_form.radio_button :sort, 'email asc', checked: 'checked' %>
        <%= search_form.radio_button :sort, 'email desc' %>
        <%= search_form.label :sort_reg, t('.sort_registration') %>
        <%= search_form.radio_button :sort, 'created_at asc' %>
        <%= search_form.radio_button :sort, 'created_at desc' %>
        
      </div>
    </div>
  <% end %>
  <%= button_tag t('buttons.search') %>
<% end %>

<%= Time.now %>

<hr>
<%= turbo_frame_tag :results, data: { turbo_action: 'advsnce' } do %>
  <%= Time.now %>
  <div id="users"></div>
  <%= turbo_frame_tag :pagination, loading: :lazy, src: users_path(format: :turbo_stream, search: params[:search]&.to_unsafe_h) %>
<% end %>



